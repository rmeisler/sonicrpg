<?xml version="1.0" encoding="UTF-8"?>
<map version="1.0" tiledversion="1.1.5" orientation="orthogonal" renderorder="right-down" width="25" height="20" tilewidth="32" tileheight="32" infinite="0" nextobjectid="22">
 <properties>
  <property name="onload" type="file" value="actions/sonicshut_intro.lua"/>
  <property name="regionName" value="Sonic's Hut"/>
 </properties>
 <tileset firstgid="1" name="knotholehut" tilewidth="32" tileheight="32" tilecount="1044" columns="29">
  <image source="../art/tiles/knotholehutinterior.png" trans="000000" width="950" height="1170"/>
 </tileset>
 <tileset firstgid="1045" source="knothole.tsx"/>
 <tileset firstgid="4529" source="robotropolis.tsx"/>
 <tileset firstgid="8029" source="cave.tsx"/>
 <layer name="floor" width="25" height="20">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,0,0,0,0,0,0,
0,0,0,0,0,0,30,31,32,33,34,35,36,37,38,39,40,41,42,0,0,0,0,0,0,
0,0,0,0,0,0,59,60,61,62,63,64,65,66,67,68,69,70,71,0,0,0,0,0,0,
0,0,0,0,0,0,88,89,90,91,92,93,94,95,96,97,98,99,100,0,0,0,0,0,0,
0,0,0,0,0,0,117,118,119,120,121,122,123,124,125,126,127,128,129,0,0,0,0,0,0,
0,0,0,0,0,0,146,147,148,149,150,151,152,153,154,155,156,157,158,0,0,0,0,0,0,
0,0,0,0,0,0,175,176,177,178,179,180,181,182,183,184,185,186,187,0,0,0,0,0,0,
0,0,0,0,0,0,204,205,206,207,208,209,210,211,212,213,214,215,216,0,0,0,0,0,0,
0,0,0,0,0,0,233,234,235,236,237,238,239,240,241,242,243,244,245,0,0,0,0,0,0,
0,0,0,0,0,0,262,263,264,265,266,267,268,269,270,271,272,273,274,0,0,0,0,0,0,
0,0,0,0,0,0,291,292,293,294,295,296,297,298,299,300,301,302,303,0,0,0,0,0,0,
0,0,0,0,0,0,320,321,322,323,324,325,326,327,328,329,330,331,332,0,0,0,0,0,0,
0,0,0,0,0,0,349,350,351,352,353,354,355,356,357,358,359,360,361,0,0,0,0,0,0,
0,0,0,0,0,0,378,379,380,381,382,383,384,385,386,387,388,389,390,0,0,0,0,0,0,
0,0,0,0,0,0,407,408,409,410,411,412,413,414,415,416,417,418,419,0,0,0,0,0,0,
0,0,0,0,0,0,436,437,438,439,440,441,442,443,444,445,446,447,448,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <layer name="above" width="25" height="20">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,467,468,469,470,471,472,0,137,138,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,496,497,498,188,189,190,0,166,167,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,525,526,527,217,218,219,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,554,555,556,246,247,248,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,583,584,585,275,276,277,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,304,305,306,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,15,16,17,18,19,20,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,43,44,45,46,47,48,49,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,72,73,74,75,76,77,78,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,101,102,103,104,105,106,107,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,130,131,132,133,134,135,136,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,159,160,161,162,163,164,165,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <layer name="above2" width="25" height="20">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,221,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,196,0,250,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,193,194,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,222,223,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <objectgroup name="objects">
  <object id="1" name="Chest1" type="Chest" gid="6839" x="544" y="448" width="64" height="64">
   <properties>
    <property name="GreenLeaf" type="int" value="1"/>
    <property name="sprite" type="file" value="../art/sprites/chest2.png"/>
   </properties>
  </object>
  <object id="3" name="Spawn 1" type="Player" gid="4565" x="384" y="288" width="32" height="32"/>
  <object id="4" name="Door" type="Door" gid="6839" x="352" y="608" width="64" height="64">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="alignOffsetX" type="float" value="-20"/>
    <property name="alignOffsetY" type="float" value="-32"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="key" value="down"/>
    <property name="orientation" value="up"/>
    <property name="scene" type="file" value="knothole.lua"/>
    <property name="spawn_point" value="SonicHutDoor"/>
    <property name="spawn_point_offset_x" type="float" value="16"/>
    <property name="spawn_point_offset_y" type="float" value="40"/>
    <property name="sprite" type="file" value="../art/sprites/hutdoor.png"/>
   </properties>
  </object>
  <object id="5" name="Photo" type="BasicNPC" gid="6839" x="480" y="224" width="32" height="32">
   <properties>
    <property name="ghost" type="bool" value="true"/>
    <property name="onInteract">local Serial = require &quot;actions/Serial&quot;
local MessageBox = require &quot;actions/MessageBox&quot;
local Ease = require &quot;actions/Ease&quot;
local Do = require &quot;actions/Do&quot;

local SpriteNode = require &quot;object/SpriteNode&quot;
local Transform = require &quot;util/Transform&quot;
local Rect = unpack(require &quot;util/Shapes&quot;)

return function(self)
    local pic = SpriteNode(self.scene, Transform(0,0,1,1), {255,255,255,0}, &quot;splash/sonicpicture&quot;, nil, nil, &quot;ui&quot;)

    local w = (love.graphics.getWidth() - 10)
    local h = 160
    local rect = Rect(Transform(love.graphics.getWidth() / 2, h/2), w, h)

    return Serial {
        Ease(pic.color, 4, 255, 1, &quot;linear&quot;),
        MessageBox {
            message = &quot;Sonic: Uncle Chuck and Muttski...&quot;,
            textSpeed = 3,
            rect = rect,
            blocking = true
        },
        MessageBox {
            message = &quot;Sonic: Don't worry guys, {p40}I'll save ya one of these days.&quot;,
            rect = rect,
            blocking = true
        },
        Ease(pic.color, 4, 0, 1, &quot;linear&quot;),
        Do(function() pic:remove() end)
    }
end</property>
   </properties>
  </object>
  <object id="7" name="Guitar" type="BasicNPC" gid="6839" x="224" y="320" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="onInteract">local Serial = require &quot;actions/Serial&quot;
local MessageBox = require &quot;actions/MessageBox&quot;
local Ease = require &quot;actions/Ease&quot;
local Do = require &quot;actions/Do&quot;
local Menu = require &quot;actions/Menu&quot;
local PlayAudio = require &quot;actions/PlayAudio&quot;
local BlockPlayer = require &quot;actions/BlockPlayer&quot;

local Transform = require &quot;util/Transform&quot;
local Layout = require &quot;util/Layout&quot;

return function(self)
    return BlockPlayer { Menu {
        layout = Layout {
            {Layout.Text(&quot;Play guitar?&quot;), selectable = false},
            {Layout.Text(&quot;Yes&quot;), choose = function(menu)
                menu:close()
                self.scene:run {
                    menu,
                    MessageBox {
                        message = &quot;Sonic: Eh, {p40}a little heavy metal isn't the worst way to start the morning...&quot;,
                        blocking = true
                    },
                    Do(function()
                        self.hidden = true
                        self.scene.player.noIdle = true
                        self.scene.player.sprite:setAnimation(&quot;guitarstrum&quot;)
                    end),
                    PlayAudio(&quot;music&quot;, &quot;sonicguitar&quot;, 1.0),
                    MessageBox {
                        message = &quot;Sonic: Way past cool! {p40}I need to play this thing more.&quot;,
                        blocking = true
                    },
                    Do(function()
                        self.scene.player.noIdle = false
                        self.hidden = false
                    end),
                    PlayAudio(&quot;music&quot;, &quot;knotholehut&quot;, 1.0, true),
                }
            end},
            {Layout.Text(&quot;No&quot;), choose = function(menu) menu:close() end},
        },
        cancellable = true,
        transform = Transform(love.graphics.getWidth()/2, love.graphics.getHeight()/2 + 30),
        selectedRow = 2,
        blocking = true
    },
    Do(function() self:refreshKeyHint() end)
    }
end</property>
    <property name="sprite" type="file" value="../art/sprites/guitar.png"/>
   </properties>
  </object>
  <object id="11" name="Brightness" type="BasicNPC" gid="6860" x="320" y="288" width="64" height="64">
   <properties>
    <property name="ghost" type="bool" value="true"/>
    <property name="notColliding">return function(self, player)
    player.lights[tostring(self)] = nil
end</property>
    <property name="whileColliding">return function(self, player)
    player.lights[tostring(self)] = true
end</property>
   </properties>
  </object>
  <object id="12" name="Pot" type="BasicNPC" gid="6839" x="224" y="416" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="defaultAnim" value="tall"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/pot.png"/>
   </properties>
  </object>
  <object id="13" name="Pot" type="BasicNPC" gid="6839" x="192" y="416" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="defaultAnim" value="tall"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/pot.png"/>
   </properties>
  </object>
  <object id="14" name="Pot" type="BasicNPC" gid="6839" x="224" y="384" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="defaultAnim" value="tall"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/pot.png"/>
   </properties>
  </object>
  <object id="15" name="Pot" type="BasicNPC" gid="6839" x="192" y="384" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="defaultAnim" value="tall"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/pot.png"/>
   </properties>
  </object>
  <object id="16" name="Pot" type="BasicNPC" gid="6839" x="544" y="384" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="defaultAnim" value="short"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/pot.png"/>
   </properties>
  </object>
  <object id="17" name="Pot" type="BasicNPC" gid="6839" x="576" y="384" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="defaultAnim" value="short"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/pot.png"/>
   </properties>
  </object>
  <object id="18" name="Pot" type="BasicNPC" gid="6839" x="544" y="320" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="defaultAnim" value="plant"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/pot.png"/>
   </properties>
  </object>
  <object id="19" name="AlarmClock" type="BasicNPC" gid="6839" x="320" y="256" width="32" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="alignOffsetY" type="float" value="-32"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="onInteract">local Serial = require &quot;actions/Serial&quot;
local Parallel = require &quot;actions/Parallel&quot;
local Do = require &quot;actions/Do&quot;
local Animate = require &quot;actions/Animate&quot;
local MessageBox = require &quot;actions/MessageBox&quot;

return function(self)
    return Serial {
        Do(function()
            self.scene.player.cinematicStack = self.scene.player.cinematicStack + 1
            self.scene.player.noIdle = true
        end),
        MessageBox {
            message = &quot;Sonic: Ugh. {p40}I can't believe Sal is making us use these alarm clocks...&quot;
        },
        Parallel {
            Animate(self.scene.player.sprite, &quot;irritated&quot;, true),
            MessageBox {
                message = &quot;Sonic: Doesn't she know that a hedgehog needs his beauty sleep?!&quot;
            }
        },
        Do(function()
            self.scene.player.cinematicStack = self.scene.player.cinematicStack - 1
            self.scene.player.noIdle = false
            self.scene.player.state = &quot;idledown&quot;
            self.scene.player.hidekeyhints[tostring(self)] = nil
        end)
    }
end</property>
    <property name="sprite" type="file" value="../art/sprites/clock.png"/>
   </properties>
  </object>
 </objectgroup>
 <layer name="Collision" width="25" height="20" visible="0">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,119,119,119,119,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,119,119,119,119,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,119,119,119,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,119,119,119,0,0,0,0,119,119,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,119,119,119,0,0,0,0,0,
0,0,0,0,0,119,119,119,0,0,0,0,0,0,0,0,0,119,119,119,0,0,0,0,0,
0,0,0,0,0,119,119,119,0,0,0,0,0,0,0,0,0,119,119,119,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <layer name="BunnyExtCollision" width="25" height="20" visible="0">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
</map>
