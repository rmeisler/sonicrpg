<?xml version="1.0" encoding="UTF-8"?>
<map version="1.0" tiledversion="1.1.5" orientation="orthogonal" renderorder="right-down" width="25" height="20" tilewidth="32" tileheight="32" infinite="0" nextobjectid="25">
 <tileset firstgid="1" name="knotholehut" tilewidth="32" tileheight="32" tilecount="1044" columns="29">
  <image source="../art/tiles/knotholehutinterior.png" trans="000000" width="950" height="1170"/>
 </tileset>
 <tileset firstgid="1045" source="knothole.tsx"/>
 <tileset firstgid="4529" source="robotropolis.tsx"/>
 <tileset firstgid="8029" source="cave.tsx"/>
 <tileset firstgid="10374" source="knotholeindoors.tsx"/>
 <tileset firstgid="12176" source="ironlock.tsx"/>
 <layer name="floor" width="25" height="20">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,17234,17235,17236,17237,17234,17235,17236,17237,17234,17235,17236,17237,0,0,0,0,0,0,0,
0,0,0,0,0,0,17304,17305,17306,17307,17304,17305,17306,17307,17304,17305,17306,17307,0,0,0,0,0,0,0,
0,0,0,0,0,0,17374,17375,17376,17377,17374,17375,17376,17377,17374,17375,17376,17377,0,0,0,0,0,0,0,
0,0,0,0,0,0,17444,17445,17446,17447,17444,17445,17446,17447,17444,17445,17446,17447,0,0,0,0,0,0,0,
0,0,0,0,0,0,17514,17515,17516,17517,17514,17515,17516,17517,17514,17515,17516,17517,0,0,0,0,0,0,0,
0,0,0,0,0,0,17584,17585,17586,17587,17584,17585,17586,17587,17584,17585,17586,17587,0,0,0,0,0,0,0,
0,0,0,0,0,0,17234,17235,17236,17237,17234,17235,17236,17237,17234,17235,17236,17237,0,0,0,0,0,0,0,
0,0,0,0,0,0,17304,17305,17306,17307,17304,17305,17306,17307,17304,17305,17306,17307,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <objectgroup name="below">
  <object id="23" name="TrapDoor" type="BasicNPC" gid="6839" x="256" y="448" width="256" height="192">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="sprite" type="file" value="../art/sprites/trapdoor.png"/>
   </properties>
  </object>
 </objectgroup>
 <layer name="above" width="25" height="20">
  <data encoding="csv">
0,0,0,0,0,0,16782,16783,16720,16721,16720,16720,16721,16720,16790,16791,16784,16785,0,0,0,0,0,0,0,
0,0,0,0,0,0,16712,16713,16790,16791,16790,16790,16791,16721,16791,16721,16714,16715,0,0,0,0,0,0,0,
0,0,0,0,0,0,16782,16783,16791,16720,16721,16717,16718,16719,16790,16791,16784,16785,0,0,0,0,0,0,0,
0,0,0,0,0,0,16712,16713,16719,16790,16791,16787,16788,16789,16721,16719,16714,16715,0,0,0,0,0,0,0,
0,0,0,0,0,0,18007,18007,18007,18007,18007,18007,18007,18007,18007,18007,18007,18007,0,0,0,0,0,0,0,
0,0,0,0,0,0,18147,18147,18077,18147,18147,18147,18147,18147,18147,18147,18147,18147,0,0,0,0,0,0,0,
0,0,0,0,0,0,18217,18217,18217,18217,18217,18217,18217,18217,18217,18217,18217,18217,0,0,0,0,0,0,0,
0,0,0,0,0,0,17164,17165,17166,17166,17165,17166,17166,17166,17165,17166,17165,17167,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,18812,18813,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,18882,18883,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <objectgroup name="objects">
  <object id="2" name="Door" type="Door" gid="6839" x="352" y="512" width="64" height="32">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="alignOffsetX" type="float" value="-20"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="key" value="down"/>
    <property name="orientation" value="up"/>
    <property name="scene" type="file" value="ironlock3.lua"/>
    <property name="spawn_point" value="Door3"/>
    <property name="spawn_point_offset_x" type="float" value="16"/>
    <property name="spawn_point_offset_y" type="float" value="40"/>
    <property name="sprite" type="file" value="../art/sprites/door6.png"/>
   </properties>
  </object>
  <object id="24" name="Sparkle" type="BasicNPC" gid="6839" x="352" y="352" width="64" height="64">
   <properties>
    <property name="align" value="bottom_left"/>
    <property name="alignOffsetX" type="float" value="32"/>
    <property name="ghost" type="bool" value="true"/>
    <property name="onInteract">local BlockPlayer = require &quot;actions/BlockPlayer&quot;
local MessageBox = require &quot;actions/MessageBox&quot;
local Animate = require &quot;actions/Animate&quot;
local Wait = require &quot;actions/Wait&quot;
local Parallel = require &quot;actions/Parallel&quot;
local Ease = require &quot;actions/Ease&quot;
local Do = require &quot;actions/Do&quot;
local AudioFade = require &quot;actions/AudioFade&quot;
local PlayAudio = require &quot;actions/PlayAudio&quot;

return function(self)
    self.scene.player.x = self.x + 16
    self.scene.player.y = self.y - 64
    self.scene.player.x = self.scene.player.x - 60
    local walkout, walkin, sprites = self.scene.player:split{GameState.party.antoine, GameState.party.sonic, GameState.party.sally}
    return BlockPlayer {
        walkout,
        AudioFade(&quot;music&quot;, 1.0, 0.0, 1),
        PlayAudio(&quot;sfx&quot;, &quot;openchasm&quot;, 1.0, true),
        Animate(self.scene.objectLookup.TrapDoor.sprite, &quot;opening&quot;),
        Animate(self.scene.objectLookup.TrapDoor.sprite, &quot;open&quot;),
        Animate(sprites.antoine.sprite, &quot;shock&quot;),
        Animate(sprites.sonic.sprite, &quot;shock&quot;),
        Parallel {
            Do(function()
                for _,layer in pairs(self.scene.map.layers) do
                    if layer.name == &quot;hidden&quot; then
                        layer.opacity = 1.0
                        return
                    end
                end
            end),
            Ease(sprites.sonic, &quot;y&quot;, sprites.sonic.y + 300, 5),
            Ease(sprites.sally, &quot;y&quot;, sprites.sally.y + 300, 5),
            Ease(sprites.antoine, &quot;y&quot;, sprites.antoine.y + 300, 5)
        },
        Do(function()
            self.scene:changeScene{map=&quot;ironlock2&quot;, fadeOutSpeed=0.3, fadeInSpeed=0.3, spawnPoint=&quot;SpawnPoint&quot;, hint=&quot;thirdfloor&quot;}
        end)
    }
end</property>
    <property name="sprite" type="file" value="../art/sprites/sparkle.png"/>
   </properties>
  </object>
 </objectgroup>
 <layer name="hidden" width="25" height="20" opacity="0">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,17234,17235,17236,17237,17234,17235,17236,17237,17234,17235,17236,17237,0,0,0,0,0,0,0,
0,0,0,0,0,0,17304,17305,17306,17307,17304,17305,17306,17307,17304,17305,17306,17307,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <layer name="top" width="25" height="20">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,0,0,
0,0,0,0,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,0,0,
0,0,0,0,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,0,0,
0,0,0,0,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,16885,0,0
</data>
 </layer>
 <layer name="Collision" width="25" height="20" visible="0">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,0,0,0,0,0,0,0,0,0,0,0,0,16887,0,0,0,0,0,0,
0,0,0,0,0,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,16887,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
 <layer name="BunnyExtCollision" width="25" height="20" visible="0">
  <data encoding="csv">
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</data>
 </layer>
</map>
